/*! ticket 2016-04-19 */
var app=angular.module("ticketApp",[]);app.controller("TicketController",["$scope","$http",function(a,b){a.ticket={},a.allTickets=[],a.chunkedTickets=[],a.formActive=!1,a.btnText="New Ticket",a.slideClass="",a.edit={},a.createTicket=function(){a.toggleForm(),b.post("/tickets/new",a.ticket).then(function(b){console.log("saved ticket",b),a.resetForm(),a.getData()})},a.saveTicket=function(c){console.log(c,"save"),b.put("tickets/edit",c).then(function(b){console.log(b),a.getData()}),a.allTickets.forEach(function(a){a.edit=!1,a.border=null})},a.getData=function(){b.get("/tickets").then(function(b){a.allTickets=b.data,a.chunkedTickets=a.chunk(a.allTickets,3)})},a.prettyDate=function(a){var b=a.toString().match(/\d+-\d+-\d+/)[0].split("-");return b[1]+"-"+b[2]+"-"+b[0]},a.deleteTicket=function(c){b["delete"]("/tickets/delete/"+c._id).then(function(b){console.log("deleted ticket"),a.getData()})},a.editTicket=function(b){a.allTickets.forEach(function(a){a.edit=!1}),a.edit=a.allTickets[a.allTickets.indexOf(b)],a.allTickets[a.allTickets.indexOf(b)].edit=!0,a.allTickets[a.allTickets.indexOf(b)].border="red"},a.cancelEdit=function(b){a.allTickets.forEach(function(a){a.edit=!1,a.border=null}),a.getData()},a.toggleForm=function(){a.formActive?(a.formActive=!1,a.slideClass="",a.btnText="New Ticket"):(a.formActive=!0,a.slideClass="slide",a.btnText="Hide Form")},a.chunk=function(a,b){for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c},a.resetForm=function(){a.ticket.name="",a.ticket.type="",a.ticket.priority="",a.ticket.description="",a.ticket.assignee="",a.ticket.reporter=""},a.getData()}]);